<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Game!</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/create.js"></script>
</head>
<body onload="init();">
<canvas id="demoCanvas" width="1024" height="768"></canvas>

<button id="btn1">btn1</button>
<button id="btn2">btn2</button>
<button id="btn3">btn3</button>
<button id="btn4">btn4</button>

<script >
    var socket = io(':8000/display');
    $(document).ready(function() {
        socket.on('event' , function(data) {
            $("#events").append(data);
        });
    });

    function team(name, x, y, color) {
        this.name = name;
        //this.position = {x : x, y : y};
        this.color = color;

        this.symbol = new createjs.Shape();
        this.symbol.graphics.beginFill(this.color).drawCircle(0, 0, 120);

        this.textBox = new createjs.Text(this.name, "30px Arial", "#ffffff");
        this.textBox.textAlign = "center";
        this.textBox.textBaseline = "middle";

        this.container = new createjs.Container();
        this.container.addChild(this.symbol, this.textBox);
        this.container.x = x;
        this.container.y = y;

        this.buttonPressed = function() {
            createjs.Tween.get(this.symbol, { loop: true })
                    .to({ scaleX: 2, scaleY: 2 }, 500, createjs.Ease.getPowInOut(2))
                    .to({ scaleX: 1, scaleY: 1 }, 500, createjs.Ease.getPowInOut(2));
            createjs.Tween.get(this.textBox, { loop: true })
                    .to({ rotation: 20 }, 125, createjs.Ease.getPowOut(2))
                    .to({ rotation: -20 }, 250, createjs.Ease.getPowInOut(2))
                    .to({ rotation: 0 }, 125, createjs.Ease.getPowIn(2));
            setTimeout(teams[1].resetState,1000);
        };

        this.resetState = function() {
            console.log(this.symbol);
            createjs.Tween.get(this.symbol, {override: true})
                    .to({ scaleX: 1, scaleY: 1 }, 500, createjs.Ease.getPowInOut(2));
            createjs.Tween.get(this.textBox, {override: true})
                    .to({ rotation: 0 }, 125, createjs.Ease.getPowInOut(2));
        };
    }

    var teamManager = {

    };

    var teams = {
        1: new team("Team1", 250, 250, "red"),
        2: new team("Team2", 1024-250, 250, "blue"),
        3: new team("Team3", 250, 768-250, "marron"),
        4: new team("Team4", 1024-250, 768-250, "green")
    };

    function init() {
        //socket.on('event' , function(data) {
        //    console.log(data);
        //});

        var stage = new createjs.Stage("demoCanvas");
        $.each(teams, function(key,value) {
            stage.addChild(value.container);
        });
        createjs.Ticker.framerate=60;
        createjs.Ticker.addEventListener("tick", stage);
        //stage.update();

        $('#btn1').click(function(){ teams[1].buttonPressed();});
        $('#btn2').click(function(){ teams[2].buttonPressed();});
        $('#btn3').click(function(){ teams[3].buttonPressed();});
        $('#btn4').click(function(){ teams[4].buttonPressed();});
    };

</script>
</body>
</html>